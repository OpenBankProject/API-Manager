{% extends 'base.html' %} {% load static %} {% load i18n %}
{% block page_title %}{{ block.super }} / Atms{% endblock page_title %} {% block content %}
<div id="atms">
    <h1>{% trans "ATM Detail" %}</h1>
    <h2>{{ bank_id }} : {{ atm_id }}</h2>
    <input type="hidden" value="{{bank_id}}" id="current_bank_id" />
    <input type="hidden" value="{{atm_id}}" id="current_atm_id" />
    <form method="post">
        {% csrf_token %} {% if form.non_field_errors %}
        <div class="alert alert-danger">
            {{ form.non_field_errors }}
        </div>
        {% endif %}
        <div class="row" style="display: None">
            <div class="col-xs-12 col-sm-4">
                {% if form.bank_id.errors %}
                <div class="alert alert-danger">{{ form.bank_id.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.bank_id.label_tag }} {{ form.bank_id }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.atm_id.errors %}
                <div class="alert alert-danger">{{ form.atm_id.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.atm_id.label_tag }} {{ form.atm_id }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.name.errors %}
                <div class="alert alert-danger">{{ form.name.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.name.label_tag }} {{ form.name }}
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-xs-12 col-sm-4">
                {% if form.services.errors %}
                <div class="alert alert-danger">{{ form.services.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.services.label_tag }} {{ form.services }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.location_latitude.errors %}
                <div class="alert alert-danger">{{ form.location_latitude.errors }}
                </div>{% endif %}
                <div class="form-group">
                    {{ form.location_latitude.label_tag }} {{ form.location_latitude }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.location_longitude.errors %}
                <div class="alert alert-danger">{{ form.location_longitude.errors }}
                </div>{% endif %}
                <div class="form-group">
                    {{ form.location_longitude.label_tag }} {{ form.location_longitude }}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-4">
                {% if form.meta_license_name.errors %}
                <div class="alert alert-danger">{{ form.meta_license_name.errors }}
                </div>{% endif %}
                <div class="form-group">
                    {{ form.meta_license_name.label_tag }} {{ form.meta_license_name }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.located_at.errors %}
                <div class="alert alert-danger">{{ form.located_at.errors }}
                </div>{% endif %}
                <div class="form-group">
                    {{ form.located_at.label_tag }} {{ form.located_at }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.has_deposit_capability.errors %}
                <div class="alert alert-danger">{{ form.has_deposit_capability.errors }}
                </div>{% endif %}
                <div class="form-group">
                    {{ form.has_deposit_capability.label_tag }} {{ form.has_deposit_capability }}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-4">
                {% if form.is_accessible.errors %}
                <div class="alert alert-danger">{{ form.is_accessible.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.is_accessible.label_tag }} {{ form.is_accessible }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.accessibility_features.errors %}
                <div class="alert alert-danger">{{ form.accessibility_features.errors }}</div>
                {% endif %}
                <div class="form-group">
                    {{ form.accessibility_features.label_tag }} {{ form.accessibility_features }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.more_info.errors %}
                <div class="alert alert-danger">{{ form.more_info.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.more_info.label_tag }} {{ form.more_info }}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-4">
                {% if form.notes.errors %}
                <div class="alert alert-danger">{{ form.notes.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.notes.label_tag }} {{ form.notes }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.supported_languages.errors %}
                <div class="alert alert-danger">{{ form.supported_languages.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.supported_languages.label_tag }} {{ form.supported_languages }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.supported_currencies.errors %}
                <div class="alert alert-danger">{{ form.supported_currencies.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.supported_currencies.label_tag }} {{ form.supported_currencies }}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-4">
                {% if form.location_categories.errors %}
                <div class="alert alert-danger">{{ form.location_categories.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.location_categories.label_tag }} {{ form.location_categories }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.minimum_withdrawal.errors %}
                <div class="alert alert-danger">{{ form.minimum_withdrawal.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.minimum_withdrawal.label_tag }} {{ form.minimum_withdrawal }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.site_name.errors %}
                <div class="alert alert-danger">{{ form.site_name.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.site_name.label_tag }} {{ form.site_name }}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-4">
                {% if form.branch_identification.errors %}
                <div class="alert alert-danger">{{ form.branch_identification.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.branch_identification.label_tag }} {{ form.branch_identification }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.site_identification.errors %}
                <div class="alert alert-danger">{{ form.site_identification.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.site_identification.label_tag }} {{ form.site_identification }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.cash_withdrawal_national_fee.errors %}
                <div class="alert alert-danger">{{ form.cash_withdrawal_national_fee.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.cash_withdrawal_national_fee.label_tag }} {{ form.cash_withdrawal_national_fee }}
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-4">
                {% if form.balance_inquiry_fee.errors %}
                <div class="alert alert-danger">{{ form.balance_inquiry_fee.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.balance_inquiry_fee.label_tag }} {{ form.balance_inquiry_fee }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.cash_withdrawal_international_fee.errors %}
                <div class="alert alert-danger">{{ form.cash_withdrawal_international_fee.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.cash_withdrawal_international_fee.label_tag }} {{ form.cash_withdrawal_international_fee }}
                </div>
            </div>
        </div>
        <div class="row">

            <div class="col-xs-12 col-sm-4">
                {% if form.address.errors %}
                <div class="alert alert-danger">{{ form.address.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.address.label_tag }} {{ form.address }}
                </div>
            </div>
            <div class="col-xs-12 col-sm-4">
                {% if form.lobby.errors %}
                <div class="alert alert-danger">{{ form.lobby.errors }}</div>{% endif %}
                <div class="form-group">
                    {{ form.lobby.label_tag }} {{ form.lobby }}
                </div>
            </div>
        </div>
        <input type="submit" value="Update" class="btn btn-primary"/>
    </form>
    <form method ="POST">
        {% csrf_token %}
        <div class="row">
            <h1>ATM Attributes</h1>
            <div class="col-xs-12 col-sm-3">
                <label class="form-group">{% trans "Attribute Name" %}</label>
            </div>
            <div class="col-xs-12 col-sm-3">
                <label class="form-group">{% trans "Attribute Type" %}</label>
            </div>
            <div class="col-xs-12 col-sm-3">
                <label class="form-group">{% trans "Attribute Value" %}</label>
            </div>
        </div>
        <div class="runner">
            <div class="row">
                <div class="col-xs-12 col-sm-3">
                    <div class="form-group" cols="1" rows="1">
                        <input class="atm_attribute_name form-control" placeholder="ATTRIBUTE_1">
                    </div>
                </div>
                <div class="col-xs-12 col-sm-3">
                    <div class="form-group" cols="1" rows="1">
                        {{ form.type_attribute }}
                    </div>
                </div>
                <div class="col-xs-6 col-sm-3">
                    <div class="form-group" cols="1" rows="1">
                        <input class="atm_attribute_value form-control" placeholder="abc">
                    </div>
                </div>
                <div class="col-sm-6 col-sm-3">
                    <div class="form-group">
                        <button class="btn btn-primary btn-green forSave">{% trans "Create" %}</button>
                    </div>
                </div>
            </div>
        </div>
        {% for attribute in atm_attributes_list %}
        {% url 'my-atm-attribute-detail' attribute.atm_attribute_id as url_atm_attribute_detail %}
        <div class="runner">

            <div class="row">

                {% if attribute.atm_attribute_id %}
                <input type ="hidden" class="atm_attribute_id" value="{{ attribute.atm_attribute_id }}">
                <div class="col-xs-12 col-sm-3">
                    <div class="form-group" cols="1" rows="1">
                        <div>
                            <input class="atm_attribute_name form-control" value="{{ attribute.name }}">
                        </div>
                    </div>
                </div>
                <div class="col-xs-12 col-sm-3">
                    <div class="form-group" cols="1" rows="1">
                        <div>
                            <input class="atm_attribute_type form-control" value="{{ attribute.type }}">
                        </div>
                    </div>
                </div>
                <div class="col-xs-6 col-sm-3">
                    <div class="form-group" cols="1" rows="1">
                        <div>
                            <input class="atm_attribute_value form-control" value="{{ attribute.value }}">
                        </div>
                    </div>
                </div>
                {% endif %}
                <div class="col-sm-3 col-sm-1">
                    <div class="form-group">
                        <button class="btn btn-primary forUpdate">{% trans "Update" %}</button>
                    </div>
                </div>
                <div class="col-sm-3 col-sm-1">
                    <div class="form-group">
                        <button class="btn btn-primary btn-red forDelete">{% trans "Delete" %}</button>
                    </div>
                </div>

            </div>
        </div>
        {% endfor %}
    </form></div>
<script type="text/javascript" src="{% static 'js/jquery.min.js' %}"></script>
<script>
    $(document).ready(function($) {
    var bank_id = $('#current_bank_id').val();
    var atm_id = $('#current_atm_id').val();
    console.log(bank_id, atm_id)
    $('.runner button.forSave').click(function(e) {
        e.preventDefault();
        let runner = $(this).parent().parent().parent();
        let name = $(runner).find('.atm_attribute_name').val();
        let type = $(runner).find('.atm_attribute_type').val();
        let value = $(runner).find('.atm_attribute_value').val();
        $('.runner button.forUpdate').attr("disabled","disabled");
		$('.runner button.forSave').attr("disabled","disabled");
		$('.runner button.forDelete').attr("disabled","disabled");
		console.log(name, type, value, bank_id)
		$.post('save/attribute', {
			'name': name,
			'type': type,
			'value': value,
			'bank_id': bank_id,
			'atm_id' : atm_id
		}, function (response) {
			location.reload();

		});
    });
    $('.runner button.forUpdate').click(function(e) {
            e.preventDefault();
            let runner = $(this).parent().parent().parent();
            let atm_attribute_id = $(runner).find('.atm_attribute_id').attr("value");
            console.log(atm_attribute_id)
            let name = $(runner).find('.atm_attribute_name').val();
            let type = $(runner).find('.atm_attribute_type').val();
            let value = $(runner).find('.atm_attribute_value').val();
            console.log(name, type, value, bank_id, atm_id)
            $('.runner button.forUpdate').attr("disabled","disabled");
    		$('.runner button.forSave').attr("disabled","disabled");
    		$('.runner button.forDelete').attr("disabled","disabled");
    		$.post('updateattribute/attribute', {
    			'atm_attribute_id': atm_attribute_id,
    			'name': name,
    			'type': type,
    			'value': value,
    			'bank_id': bank_id,
			    'atm_id' : atm_id
    		}, function (response) {
    			location.reload();
    		});
        });

    $('.runner button.forDelete').click(function(e) {
		e.preventDefault();
        let runner = $(this).parent().parent().parent();
        let atm_attribute_id = $(runner).find('.atm_attribute_id').attr("value");
        console.log(atm_attribute_id)
        $('.runner button.forUpdate').attr("disabled","disabled");
		$('.runner button.forSave').attr("disabled","disabled");
		$('.runner button.forDelete').attr("disabled","disabled");
		$.post('delete/attribute', {
			'atm_attribute_id': atm_attribute_id,
			'bank_id': bank_id,
			'atm_id' : atm_id
		}, function (response) {
			location.reload();
		});
});});
</script>
{% endblock content %}

{% block extrajs %} {% comment %}

<script type="text/javascript" src="{% static 'atms/js/atms.js' %}"></script>

{% endcomment %} {% endblock extrajs %} {% block extracss %}
<link href="{% static 'atms/css/atms.css' %}" rel="stylesheet"> {% endblock extracss %}